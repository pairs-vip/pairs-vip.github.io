{"title":"接口耗时优化","date":"2025-10-21T08:32:00.000Z","date_formatted":{"ll":"Oct 21, 2025","L":"10/21/2025","MM-DD":"10-21"},"author":"zmu","link":"2025/10/21/接口耗时优化","tags":["method"],"categories":["dev"],"updated":"2025-10-21T08:32:00.000Z","content":"<h1 id=\"接口耗时优化\">接口耗时优化<a title=\"#接口耗时优化\" href=\"#接口耗时优化\"></a></h1>\n<h2 id=\"1.代码层面优化\">1.代码层面优化<a title=\"#1.代码层面优化\" href=\"#1.代码层面优化\"></a></h2>\n<p><strong>第一种方式就是通过优化代码，将代码中查询数据库的操作减少，核心就是减少数据库连接次数；</strong></p>\n<ul>\n<li>遍历查询：这种一般先将 查询id处理为list，然后使用in进行一次查询，然后在内存中使用遍历查找对应的数据条目</li>\n</ul>\n<p><strong>第二种方式是降低for循环的时间复杂度，可能会遇到循环嵌套的数据处理，核心就是降低时间复杂度；</strong></p>\n<ul>\n<li>for循环嵌套优化：将每一个List放到Map中，选用合适的属性作为键，值为Object；使用单层循环即可通过Map.get(key)获取到适配的对象，降低了时间复杂度。</li>\n</ul>\n<p><strong>第三种方式是通过条件限制查询结果数量；</strong></p>\n<ul>\n<li>限制查询结果数量：分页也算是一种调高接口查询效率的办法，但是可能大部分情况就需要列表，分页这种方式则不适合；这时候可以通过使用查询条件限制查询结果数量来调高查询速度，例如不加条件查询有1000条，但是其实我需要的就是repository为’xxxxxx’的数据，其他的我用不到，此时就可以通过添加条件  in (‘xxxxx’,‘yyyyy’,‘zzzzzz’)来减少查询结果数量，从而实现提高接口速度的目的。</li>\n</ul>\n<h2 id=\"2.数据库层面优化\">2.数据库层面优化<a title=\"#2.数据库层面优化\" href=\"#2.数据库层面优化\"></a></h2>\n<p><strong>数据库层面可以通过添加索引的方式来使得数据库查询速度更快，给需要进行筛选以及查询的属性添加索引：</strong></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 添加复合索引</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> INDEX idx_folder_members_objectId_folderId <span class=\"keyword\">ON</span> C_FOLDER_MEMBERS(objectId, folderId);</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> INDEX idx_design_part_master_id_endItem <span class=\"keyword\">ON</span> C_DESIGN_PART_MASTER(id, endItem);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 分析查询计划</span></span><br><span class=\"line\">EXPLAIN ANALYZE <span class=\"keyword\">SELECT</span> fm.folderId, <span class=\"built_in\">COUNT</span>(<span class=\"operator\">*</span>) </span><br><span class=\"line\"><span class=\"keyword\">FROM</span> C_FOLDER_MEMBERS fm </span><br><span class=\"line\"><span class=\"keyword\">INNER</span> <span class=\"keyword\">JOIN</span> C_DESIGN_PART_MASTER dpm <span class=\"keyword\">ON</span> fm.objectId <span class=\"operator\">=</span> dpm.id </span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> dpm.endItem <span class=\"operator\">=</span> <span class=\"literal\">true</span> </span><br><span class=\"line\"><span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> fm.folderId;</span><br></pre></td></tr></table></figure>\n<h2 id=\"3.缓存优化\">3.缓存优化<a title=\"#3.缓存优化\" href=\"#3.缓存优化\"></a></h2>\n<p><strong>如果查询结果不经常变化可以使用添加缓存的方式；</strong></p>\n","next":{"title":"Hello World","link":"2025/09/14/Hexo-blog使用指南"},"plink":"http://example.com/2025/10/21/接口耗时优化/","toc":[{"id":"接口耗时优化","title":"接口耗时优化","index":"1","children":[{"id":"1.代码层面优化","title":"1.代码层面优化","index":"1.1"},{"id":"2.数据库层面优化","title":"2.数据库层面优化","index":"1.2"},{"id":"3.缓存优化","title":"3.缓存优化","index":"1.3"}]}],"reading_time":"510 words in 3 min"}